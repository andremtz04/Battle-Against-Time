[gd_scene load_steps=41 format=3 uid="uid://bga6mkh5j441c"]

[ext_resource type="Script" path="res://Scripts/Main System/ui.gd" id="2_bppfq"]
[ext_resource type="Texture2D" uid="uid://blwnkhikcechp" path="res://icon.svg" id="2_hl03d"]
[ext_resource type="FontFile" uid="uid://jc25fklm5p5m" path="res://Textures/Lazy Fight.otf" id="3_4gy1q"]
[ext_resource type="Script" path="res://Scripts/Main System/main_camera.gd" id="3_a5gf1"]
[ext_resource type="Texture2D" uid="uid://bhqbrectmi14j" path="res://Textures/Towers/All_Towers.png" id="3_ldxms"]
[ext_resource type="AudioStream" uid="uid://dwiowodyq12rj" path="res://Audio/Effects/BadAction.mp3" id="5_5u5l7"]
[ext_resource type="AudioStream" uid="uid://bebyl24s5s1gd" path="res://Audio/Music/CheekyHorn.mp3" id="5_nu03c"]
[ext_resource type="Script" path="res://Scripts/Main System/enemy_wave.gd" id="6_0jpq0"]
[ext_resource type="AudioStream" uid="uid://d2stov0k3ufj1" path="res://Audio/Music/TromboneSadge.mp3" id="6_5kee7"]
[ext_resource type="Texture2D" uid="uid://g8jmh6epgfur" path="res://Textures/GUI/Sound2.png" id="6_lrlrp"]
[ext_resource type="AudioStream" uid="uid://xa1rxri2spvr" path="res://Audio/Music/Kick.mp3" id="8_exuxu"]
[ext_resource type="AudioStream" uid="uid://ch5a1flc2esql" path="res://Audio/Music/AtariBass.mp3" id="9_qn2xa"]
[ext_resource type="AudioStream" uid="uid://bs7xjlov6cm88" path="res://Audio/Music/MusicBox.mp3" id="10_qdetx"]
[ext_resource type="Shader" path="res://Shaders/vignette.gdshader" id="17_hwd1k"]
[ext_resource type="Texture2D" uid="uid://bx01w75h7o3j" path="res://Textures/Map/oak_veneer_01_diff_1k.jpg" id="18_sky8f"]
[ext_resource type="Shader" path="res://Shaders/portal.gdshader" id="21_pnqap"]
[ext_resource type="MeshLibrary" uid="uid://cy8f7gd0l6jjl" path="res://Meshes/Dungeon.tres" id="22_mjaxf"]

[sub_resource type="ShaderMaterial" id="ShaderMaterial_qimma"]
shader = ExtResource("17_hwd1k")
shader_parameter/outerRadius = 1.485
shader_parameter/MainAlpha = 0.783
shader_parameter/vignette_color = null

[sub_resource type="AtlasTexture" id="AtlasTexture_wnpie"]
atlas = ExtResource("3_ldxms")
region = Rect2(268, 15, 216, 220)

[sub_resource type="AtlasTexture" id="AtlasTexture_6erso"]
resource_local_to_scene = true
atlas = ExtResource("3_ldxms")
region = Rect2(520, 266, 200, 198)

[sub_resource type="AtlasTexture" id="AtlasTexture_o4sn0"]
atlas = ExtResource("3_ldxms")
region = Rect2(21, 259, 184, 220)

[sub_resource type="AtlasTexture" id="AtlasTexture_fcoat"]
atlas = ExtResource("3_ldxms")
region = Rect2(292, 267, 185, 206)

[sub_resource type="AtlasTexture" id="AtlasTexture_7dlls"]
atlas = ExtResource("3_ldxms")
region = Rect2(6, 5, 184, 230)

[sub_resource type="AtlasTexture" id="AtlasTexture_e3as2"]
atlas = ExtResource("3_ldxms")
region = Rect2(539, 18, 168, 197)

[sub_resource type="Environment" id="Environment_yeaxu"]

[sub_resource type="Curve3D" id="Curve3D_i2jhb"]

[sub_resource type="BoxShape3D" id="BoxShape3D_evvkq"]
size = Vector3(0.5, 1, 0.5)

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_tumpe"]
albedo_texture = ExtResource("18_sky8f")

[sub_resource type="PlaneMesh" id="PlaneMesh_yxa4q"]
material = SubResource("StandardMaterial3D_tumpe")
size = Vector2(40, 40)

[sub_resource type="ConcavePolygonShape3D" id="ConcavePolygonShape3D_iqtvg"]
data = PackedVector3Array(20, 0, 20, -20, 0, 20, 20, 0, -20, -20, 0, 20, -20, 0, -20, 20, 0, -20)

[sub_resource type="Gradient" id="Gradient_d2rkb"]
interpolation_mode = 2
offsets = PackedFloat32Array(0, 0.674603)

[sub_resource type="FastNoiseLite" id="FastNoiseLite_365wn"]
noise_type = 2
seed = 15
frequency = 0.0095

[sub_resource type="NoiseTexture2D" id="NoiseTexture2D_1nff1"]
color_ramp = SubResource("Gradient_d2rkb")
noise = SubResource("FastNoiseLite_365wn")

[sub_resource type="ShaderMaterial" id="ShaderMaterial_i2tjv"]
render_priority = 0
shader = ExtResource("21_pnqap")
shader_parameter/size = 0.3
shader_parameter/size_inner = 0.3
shader_parameter/portalFrameColor = Color(0, 0, 0, 1)
shader_parameter/portalHighlightColor = Color(1, 0, 0, 1)
shader_parameter/inner = null
shader_parameter/noise = SubResource("NoiseTexture2D_1nff1")

[sub_resource type="PlaneMesh" id="PlaneMesh_cer8c"]
resource_local_to_scene = true
material = SubResource("ShaderMaterial_i2tjv")
size = Vector2(1.5, 1.5)

[sub_resource type="Gradient" id="Gradient_x37c6"]

[sub_resource type="FastNoiseLite" id="FastNoiseLite_6u274"]

[sub_resource type="NoiseTexture2D" id="NoiseTexture2D_p8ldj"]
color_ramp = SubResource("Gradient_x37c6")
noise = SubResource("FastNoiseLite_6u274")

[sub_resource type="ShaderMaterial" id="ShaderMaterial_mxqvd"]
render_priority = 0
shader = ExtResource("21_pnqap")
shader_parameter/size = 0.3
shader_parameter/size_inner = 0.3
shader_parameter/portalFrameColor = null
shader_parameter/portalHighlightColor = Color(0, 0, 1, 1)
shader_parameter/inner = null
shader_parameter/noise = SubResource("NoiseTexture2D_p8ldj")

[sub_resource type="PlaneMesh" id="PlaneMesh_e3fqb"]
material = SubResource("ShaderMaterial_mxqvd")
size = Vector2(1.5, 1.5)

[node name="Map" type="Node3D"]

[node name="UI" type="Control" parent="."]
layout_mode = 3
anchors_preset = 0
offset_right = 40.0
offset_bottom = 40.0
script = ExtResource("2_bppfq")

[node name="TextContain" type="VBoxContainer" parent="UI"]
layout_mode = 0
offset_left = 10.0
offset_top = 10.0
offset_right = 260.0
offset_bottom = 110.0

[node name="Round" type="RichTextLabel" parent="UI/TextContain"]
layout_mode = 2
theme_override_colors/font_shadow_color = Color(0, 0, 0, 1)
theme_override_constants/shadow_outline_size = 7
theme_override_fonts/normal_font = ExtResource("3_4gy1q")
text = "Round:"
fit_content = true
scroll_active = false

[node name="Health" type="RichTextLabel" parent="UI/TextContain"]
layout_mode = 2
theme_override_colors/font_shadow_color = Color(0, 0, 0, 1)
theme_override_constants/shadow_outline_size = 7
theme_override_fonts/normal_font = ExtResource("3_4gy1q")
text = "Health:"
fit_content = true
scroll_active = false

[node name="Money" type="RichTextLabel" parent="UI/TextContain"]
layout_mode = 2
theme_override_colors/font_shadow_color = Color(0, 0, 0, 1)
theme_override_constants/shadow_outline_size = 7
theme_override_fonts/normal_font = ExtResource("3_4gy1q")
text = "Money:"
fit_content = true
scroll_active = false

[node name="DarkOverlay" type="ColorRect" parent="UI"]
z_index = -3
material = SubResource("ShaderMaterial_qimma")
layout_mode = 1
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
offset_right = 1112.0
offset_bottom = 608.0
grow_horizontal = 2
grow_vertical = 2
size_flags_horizontal = 4

[node name="TowerPrice" type="Control" parent="UI"]
layout_mode = 2
anchors_preset = 0
offset_right = 6.0
offset_bottom = 204.0

[node name="HealerPrice" type="RichTextLabel" parent="UI/TowerPrice"]
layout_mode = 2
offset_left = 970.0
offset_top = 128.0
offset_right = 1020.0
offset_bottom = 178.0
theme_override_colors/font_shadow_color = Color(0, 0, 0, 1)
theme_override_constants/shadow_outline_size = 7
theme_override_fonts/normal_font = ExtResource("3_4gy1q")
fit_content = true
scroll_active = false

[node name="FistPrice" type="RichTextLabel" parent="UI/TowerPrice"]
layout_mode = 2
offset_left = 1056.0
offset_top = 128.0
offset_right = 1106.0
offset_bottom = 178.0
theme_override_colors/font_shadow_color = Color(0, 0, 0, 1)
theme_override_constants/shadow_outline_size = 7
theme_override_fonts/normal_font = ExtResource("3_4gy1q")

[node name="MagePrice" type="RichTextLabel" parent="UI/TowerPrice"]
layout_mode = 2
offset_left = 970.0
offset_top = 267.0
offset_right = 1020.0
offset_bottom = 317.0
theme_override_colors/font_shadow_color = Color(0, 0, 0, 1)
theme_override_constants/shadow_outline_size = 7
theme_override_fonts/normal_font = ExtResource("3_4gy1q")

[node name="TankPrice" type="RichTextLabel" parent="UI/TowerPrice"]
layout_mode = 2
offset_left = 1056.0
offset_top = 267.0
offset_right = 1106.0
offset_bottom = 317.0
theme_override_colors/font_shadow_color = Color(0, 0, 0, 1)
theme_override_constants/shadow_outline_size = 7
theme_override_fonts/normal_font = ExtResource("3_4gy1q")

[node name="ArcherPrice" type="RichTextLabel" parent="UI/TowerPrice"]
layout_mode = 2
offset_left = 980.0
offset_top = 416.0
offset_right = 1030.0
offset_bottom = 466.0
theme_override_colors/font_shadow_color = Color(0, 0, 0, 1)
theme_override_constants/shadow_outline_size = 7
theme_override_fonts/normal_font = ExtResource("3_4gy1q")

[node name="FarmerPrice" type="RichTextLabel" parent="UI/TowerPrice"]
layout_mode = 2
offset_left = 1056.0
offset_top = 416.0
offset_right = 1106.0
offset_bottom = 466.0
theme_override_colors/font_shadow_color = Color(0, 0, 0, 1)
theme_override_constants/shadow_outline_size = 7
theme_override_fonts/normal_font = ExtResource("3_4gy1q")

[node name="GridContainer" type="GridContainer" parent="UI"]
texture_filter = 2
layout_mode = 0
offset_left = 935.0
offset_top = 15.0
offset_right = 1340.0
offset_bottom = 835.0
scale = Vector2(0.5, 0.5)
theme_override_constants/v_separation = 60
columns = 2

[node name="SpawnTower1" type="TextureButton" parent="UI/GridContainer"]
layout_mode = 2
texture_normal = SubResource("AtlasTexture_wnpie")

[node name="SpawnTower2" type="TextureButton" parent="UI/GridContainer"]
layout_mode = 2
texture_normal = SubResource("AtlasTexture_6erso")

[node name="SpawnTower3" type="TextureButton" parent="UI/GridContainer"]
layout_mode = 2
texture_normal = SubResource("AtlasTexture_o4sn0")

[node name="SpawnTower4" type="TextureButton" parent="UI/GridContainer"]
layout_mode = 2
texture_normal = SubResource("AtlasTexture_fcoat")

[node name="SpawnTower5" type="TextureButton" parent="UI/GridContainer"]
layout_mode = 2
texture_normal = SubResource("AtlasTexture_7dlls")

[node name="SpawnTower6" type="TextureButton" parent="UI/GridContainer"]
layout_mode = 2
texture_normal = SubResource("AtlasTexture_e3as2")

[node name="Play Button" type="TextureButton" parent="UI"]
layout_mode = 0
offset_left = 1004.0
offset_top = 509.0
offset_right = 1132.0
offset_bottom = 637.0
texture_normal = ExtResource("2_hl03d")

[node name="EnemyTest2" type="Button" parent="UI"]
visible = false
layout_mode = 0
offset_left = 1051.0
offset_top = 462.0
offset_right = 1112.0
offset_bottom = 493.0
text = "Enemy"

[node name="MuteButton" type="TextureButton" parent="UI"]
layout_mode = 0
offset_left = 29.0
offset_top = 523.0
offset_right = 855.0
offset_bottom = 976.0
scale = Vector2(0.209464, 0.247923)
texture_normal = ExtResource("6_lrlrp")

[node name="Lighting Stuff" type="Node3D" parent="."]

[node name="WorldEnvironment" type="WorldEnvironment" parent="Lighting Stuff"]
environment = SubResource("Environment_yeaxu")

[node name="DirectionalLight3D" type="DirectionalLight3D" parent="Lighting Stuff"]
transform = Transform3D(1, 0, 0, 0, -4.37114e-08, 1, 0, -1, -4.37114e-08, 0, 25, 0)
shadow_bias = 4.605

[node name="Camera3D" type="Camera3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 0.173648, 0.984808, 0, -0.984808, 0.173648, 9, 9.5, 7.2)
fov = 70.0
script = ExtResource("3_a5gf1")

[node name="Audio" type="Node3D" parent="Camera3D"]
transform = Transform3D(1, 0, 0, 0, 0.258819, -0.965926, 0, 0.965926, 0.258819, 0, 0, 0)

[node name="BadAction" type="AudioStreamPlayer3D" parent="Camera3D/Audio"]
stream = ExtResource("5_5u5l7")
volume_db = -4.103

[node name="WhimsyPlayer" type="AudioStreamPlayer3D" parent="Camera3D/Audio"]
stream = ExtResource("5_nu03c")
bus = &"Whimsy"
parameters/looping = true

[node name="WompPlayer" type="AudioStreamPlayer3D" parent="Camera3D/Audio"]
stream = ExtResource("6_5kee7")
bus = &"Womp"
parameters/looping = true

[node name="KickPlayer" type="AudioStreamPlayer3D" parent="Camera3D/Audio"]
stream = ExtResource("8_exuxu")
bus = &"Kick"
parameters/looping = true

[node name="BassPlayer" type="AudioStreamPlayer3D" parent="Camera3D/Audio"]
stream = ExtResource("9_qn2xa")
bus = &"Bass"
parameters/looping = true

[node name="HiTunePlayer" type="AudioStreamPlayer3D" parent="Camera3D/Audio"]
stream = ExtResource("10_qdetx")
bus = &"HiTune"
parameters/looping = true

[node name="Path1" type="Path3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0.5, 1, 1)
curve = SubResource("Curve3D_i2jhb")
script = ExtResource("6_0jpq0")

[node name="Timer" type="Timer" parent="Path1"]

[node name="End Area" type="Area3D" parent="."]
monitorable = false

[node name="CollisionShape3D" type="CollisionShape3D" parent="End Area"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 14.5, 1.5, 8.5)
shape = SubResource("BoxShape3D_evvkq")

[node name="Background Stuff" type="Node3D" parent="."]

[node name="Main Map" type="GridMap" parent="Background Stuff"]
mesh_library = ExtResource("22_mjaxf")
cell_size = Vector3(1, 1, 1)
collision_layer = 2
collision_mask = 2
collision_priority = 2.0
data = {
"cells": PackedInt32Array(0, 0, 851973, 1, 0, 655366, 2, 0, 655366, 3, 0, 655366, 4, 0, 655366, 5, 0, 655366, 6, 0, 655366, 7, 0, 655366, 8, 0, 655366, 9, 0, 655366, 10, 0, 655366, 11, 0, 655366, 12, 0, 655366, 13, 0, 786438, 14, 0, 1376261, 0, 1, 65542, 0, 2, 65542, 0, 3, 65542, 0, 4, 65542, 0, 5, 65542, 0, 6, 65542, 0, 7, 65542, 1, 1, 1441792, 2, 1, 1441792, 3, 1, 1441792, 4, 1, 1441792, 5, 1, 1441792, 6, 1, 1441792, 7, 1, 1441792, 8, 1, 1441792, 9, 1, 1441792, 10, 1, 1441792, 11, 1, 1441792, 12, 1, 1441792, 13, 1, 1441792, 14, 1, 589830, 14, 2, 589830, 14, 3, 589830, 13, 7, 1441792, 12, 7, 1441792, 5, 6, 1441792, 4, 6, 1441792, 3, 6, 1441792, 2, 6, 1441792, 1, 6, 1441792, 1, 7, 1441792, 2, 7, 1441792, 3, 7, 1441792, 4, 7, 1441792, 8, 6, 1441792, 9, 6, 1441792, 10, 6, 1441792, 11, 6, 1441792, 12, 6, 1441792, 13, 6, 1441792, 9, 5, 1441792, 8, 5, 1441792, 7, 5, 1441792, 6, 5, 1441792, 5, 5, 1441792, 2, 5, 1441792, 1, 5, 1441792, 3, 5, 1441792, 4, 5, 1441792, 6, 6, 1441792, 7, 6, 1441792, 10, 5, 1441792, 11, 5, 1441792, 12, 5, 1441792, 13, 5, 1441792, 13, 3, 1441792, 12, 3, 1441792, 12, 2, 1441792, 11, 2, 1441792, 10, 2, 1441792, 9, 2, 1441792, 8, 2, 1441792, 7, 2, 1441792, 6, 2, 1441792, 5, 2, 1441792, 5, 3, 1441792, 4, 3, 1441792, 3, 3, 1441792, 2, 3, 1441792, 2, 2, 1441792, 1, 2, 1441792, 1, 3, 1441792, 6, 3, 1441792, 6, 4, 1441792, 7, 4, 1441792, 8, 3, 1441792, 9, 3, 1441792, 10, 3, 1441792, 11, 3, 1441792, 13, 2, 1441792, 13, 4, 1441792, 12, 4, 1441792, 11, 4, 1441792, 10, 4, 1441792, 9, 4, 1441792, 8, 4, 1441792, 7, 3, 1441792, 5, 4, 1441792, 4, 4, 1441792, 3, 4, 1441792, 2, 4, 1441792, 1, 4, 1441792, 3, 2, 1441792, 4, 2, 1441792, 14, 8, 327685, 13, 8, 327686, 12, 8, 327686, 11, 8, 6, 10, 8, 327686, 9, 8, 327686, 8, 8, 327686, 7, 8, 327686, 6, 8, 327686, 5, 8, 327686, 4, 8, 327686, 3, 8, 327686, 2, 8, 6, 1, 8, 327686, 0, 8, 1441797, 5, 7, 1441792, 6, 7, 1441792, 7, 7, 1441792, 8, 7, 1441792, 9, 7, 1441792, 10, 7, 1441792, 11, 7, 1441792, 14, 4, 589830, 14, 5, 589830, 14, 6, 589830, 14, 7, 589830, 65542, 8, 655361, 65541, 8, 655361, 65540, 8, 655361, 65539, 8, 655361, 65538, 8, 655361, 65537, 8, 655361, 65547, 8, 1, 65546, 8, 1, 65545, 8, 1, 65544, 8, 1, 65543, 8, 655361, 65542, 0, 1, 65540, 0, 1, 65541, 0, 1, 65547, 0, 1, 65546, 0, 1, 65543, 0, 1, 65544, 0, 1, 65545, 0, 1, 65548, 0, 1, 65549, 0, 1, 65550, 0, 1, 65550, 1, 1, 65550, 2, 1, 65550, 3, 1, 65550, 5, 1, 65550, 4, 1, 65536, 5, 1441793, 65536, 6, 1441793, 65536, 7, 1441793, 65536, 8, 1441793, 65536, 4, 1441793, 65540, 1, 1441793, 65540, 2, 1441793, 65538, 6, 1441793, 65538, 7, 1441793, 65537, 6, 1441793, 65537, 7, 1441793, 65546, 6, 1441793, 65546, 7, 1441793, 65544, 3, 1441793, 65543, 3, 1441793, 65541, 6, 1441793, 65542, 6, 1441793)
}
metadata/_editor_floor_ = Vector3(0, 1, 0)

[node name="Wood" type="MeshInstance3D" parent="Background Stuff"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 7.7203, 0, 6.60258)
mesh = SubResource("PlaneMesh_yxa4q")
skeleton = NodePath("../Main Map")

[node name="StaticBody3D" type="StaticBody3D" parent="Background Stuff/Wood"]

[node name="CollisionShape3D" type="CollisionShape3D" parent="Background Stuff/Wood/StaticBody3D"]
shape = SubResource("ConcavePolygonShape3D_iqtvg")

[node name="EnemyStartPortal" type="MeshInstance3D" parent="Background Stuff"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0.5, 1.01, 0.5)
mesh = SubResource("PlaneMesh_cer8c")

[node name="MeshInstance3D" type="MeshInstance3D" parent="Background Stuff"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 14.5, 1.087, 8.5)
mesh = SubResource("PlaneMesh_e3fqb")

[connection signal="start_round" from="UI" to="Path1" method="_on_ui_start_round"]
[connection signal="button_down" from="UI/GridContainer/SpawnTower1" to="UI" method="_on_spawn_tower_1_button_down"]
[connection signal="button_down" from="UI/GridContainer/SpawnTower2" to="UI" method="_on_spawn_tower_2_button_down"]
[connection signal="button_down" from="UI/GridContainer/SpawnTower3" to="UI" method="_on_spawn_tower_3_button_down"]
[connection signal="button_down" from="UI/GridContainer/SpawnTower4" to="UI" method="_on_spawn_tower_4_button_down"]
[connection signal="button_down" from="UI/GridContainer/SpawnTower5" to="UI" method="_on_spawn_tower_5_button_down"]
[connection signal="button_down" from="UI/GridContainer/SpawnTower6" to="UI" method="_on_spawn_tower_6_button_down"]
[connection signal="button_down" from="UI/Play Button" to="UI" method="_on_play_button_button_down"]
[connection signal="button_down" from="UI/EnemyTest2" to="UI" method="_on_button_button_down"]
[connection signal="pressed" from="UI/MuteButton" to="Camera3D" method="_on_mute_button_pressed"]
[connection signal="placedTower" from="Camera3D" to="UI" method="_on_camera_3d_placed_tower"]
[connection signal="timeout" from="Path1/Timer" to="Path1" method="_on_timer_timeout"]
[connection signal="area_entered" from="End Area" to="Path1" method="_on_area_3d_area_entered"]
